{"version":3,"sources":["components/flightControlViewer/mapWaypoints.ts"],"names":[],"mappings":"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","file":"components/flightControlViewer/mapWaypoints.js","sourcesContent":["import { MapWaypoint } from './mapWaypoint';\nimport { MapDrone } from './mapDrone';\nimport { IGuidedWaypoint } from '@dronesense/core/lib/common/entities/IGuidedWaypoint';\nimport { FlightControlViewerEventing } from './flightControlViewer';\nimport { Conversions } from '@dronesense/model/lib/common/Utility';\n\nexport class MapWaypoints {\n\n    waypoints: Array<MapWaypoint> = [];\n\n    currentWaypoint: MapWaypoint;\n\n    currentIndex: number;\n\n    drone: MapDrone;\n\n    map: Cesium.Viewer;\n\n    color: string;\n\n    sessionId: string;\n\n    // Container for all map UI related to this session\n    mapEntityCollection: Cesium.CustomDataSource;\n\n    constructor(drone: MapDrone, map: Cesium.Viewer, color: string, sesisonId: string, entityCollection: Cesium.CustomDataSource, public eventing: FlightControlViewerEventing,\n        public $log: angular.ILogService) {\n        this.drone = drone;\n        this.map = map;\n        this.color = color;\n        this.sessionId = sesisonId;\n        this.mapEntityCollection = entityCollection;\n\n        this.startInterval();\n\n        for (let index: number = 0; index < this.drone.drone.FlightController.Guided.Waypoints.length; index++) {\n            let wp: IGuidedWaypoint = this.drone.drone.FlightController.Guided.Waypoints[index];\n\n            this.getHAE(wp.lattitude, wp.longitude).then((height: number) => {\n                \n                let newWaypoint: MapWaypoint = new MapWaypoint(wp, index, height);\n\n                this.waypoints.splice(index, 0, newWaypoint);\n\n                this.addWaypointToMap(newWaypoint);\n\n                if (!this.currentWaypoint) {\n                    if (!newWaypoint.reached) {\n                        this.currentWaypoint = newWaypoint;\n                        this.currentIndex = index;\n                    }\n                }\n\n            });\n        }\n\n        this.calculateTimeAndDistance();\n\n        this.drone.drone.FlightController.Guided.on('waypoint-added', (wayPoint: IGuidedWaypoint, index: number) => {\n\n            this.$log.log({ message: 'Waypoint Added', index: index, waypoint: wayPoint});\n\n            try {\n                this.getHAE(wayPoint.lattitude, wayPoint.longitude).then((height: number) => {\n\n                    this.waypoints.splice(index, 0, new MapWaypoint(wayPoint, index, height));\n\n                    this.addWaypointToMap(this.waypoints[index]);\n\n                    // Fix the animation clock\n                    this.map.clock.currentTime = Cesium.JulianDate.now();\n\n                    this.updateIndexes();\n\n                });\n            } catch (error) {\n                this.$log.error({ message: 'Error getting hae for waypoint and adding to map handler.', error: error });\n            }\n        });\n\n        this.drone.drone.FlightController.Guided.on('waypoint-removed', (index: number) => {\n\n            try {\n                this.$log.log({ message: 'Waypoint Removed', index: index, name: this.waypoints[index].name});\n                this.removeWaypointFromMap(this.waypoints[index].name);\n                this.waypoints.splice(index, 1);\n                this.updateIndexes();\n            } catch (error) {\n                 this.$log.error({ message: 'Error removing waypoint handler.', error: error });\n            }\n        });\n        \n        this.drone.drone.FlightController.Guided.on('waypoints-changed', () => {\n            this.$log.log({ message: 'Waypoint Changed' });\n        });\n\n        this.drone.drone.FlightController.Guided.on('waypoint-error', (index: number, error: any) => {\n\n            try {\n                this.$log.error({ message: 'Waypoint Error', index: index, name: this.waypoints[index].name, error: error});\n\n                if (this.waypoints[index]) {\n                    this.eventing.trigger('waypoint-error', this.waypoints[index].name);\n                }\n            } catch (error) {\n                this.$log.error({ message: 'Error in waypoint error handler.', error: error });\n            }\n        });\n\n        this.drone.drone.FlightController.Guided.on('waypoint-started', (index: number) => {\n\n            try {\n                this.$log.log({ message: 'Waypoint Started', index: index, name: this.waypoints[index].name });\n\n                if (this.currentWaypoint) {\n                    this.currentWaypoint.isActive = false;\n                }\n\n                this.currentWaypoint = this.waypoints[index];\n                this.currentIndex = index;\n                this.waypoints[index].isActive = true;\n            } catch (error) {\n                this.$log.error({ message: 'Error in starting waypoint handler.', error: error });\n            }\n        });\n\n        this.drone.drone.FlightController.Guided.on('waypoint-reached', (index: number) => {\n\n            try {\n                this.$log.log({ message: 'Waypoint Reached', index: index, name: this.waypoints[index].name });\n\n                this.waypoints[index].reached = true;\n                this.waypoints[index].isActive = false;\n                this.waypoints[index].entity.show = this.showHistoricalWaypoints;\n            } catch (error) {\n                this.$log.error({ message: 'Error in waypoing reached handler.', error: error });\n            }\n        });\n    }\n\n    showHistoricalWaypoints: boolean = true;\n\n    hideHistoryWaypoints(show: boolean): void {\n        this.showHistoricalWaypoints = show;\n        this.waypoints.forEach((waypoint: MapWaypoint) => {\n            if (waypoint.reached) {\n                waypoint.entity.show = show;\n            }\n        });\n    }\n\n    removeWaypointFromMap(name: string): void {\n        this.mapEntityCollection.entities.removeById(this.sessionId + name);\n    }\n\n    updateIndexes(): void {\n        this.waypoints.forEach((wp: MapWaypoint, index: number) => {\n            wp.index = index;\n        });\n    }\n\n    addWaypointToMap(waypoint: MapWaypoint): void {\n\n        try {\n\n        if (!waypoint) {\n            return;\n        }\n\n        // create the svg image string\n        let svgDataDeclare: string = 'data:image/svg+xml,';\n        //var svgCircle: string = '<path style=\"fill:#ffffff\" d=\"M12,23.9L0.1,12L12,0.1L23.9,12L12,23.9z M4.4,12l7.6,7.6l7.6-7.6L12,4.4L4.4,12z\"/>';\n        let svgCircle: string =\n        `<defs>\n            <rect id=\"path-1\" x=\"6\" y=\"6\" width=\"25\" height=\"25\"></rect>\n        </defs>\n        <g id=\"Flight-Plan\" stroke=\"none\" stroke-width=\"1\" fill=\"none\" fill-rule=\"evenodd\">\n            <g id=\"Rectangle-474\" transform=\"translate(18.500000, 18.500000) rotate(-315.000000) translate(-18.500000, -18.500000) \">\n                <use stroke=\"#FFFFFF\" stroke-width=\"2\" fill-opacity=\"0.5\" fill=\"` + this.color + `\" fill-rule=\"evenodd\" xlink:href=\"#path-1\"></use>\n            </g>\n            <text id=\"2\" font-family=\"OpenSans\" font-size=\"15\" font-weight=\"500\" fill=\"#FFFFFF\">\n                <tspan text-anchor=\"middle\" x=\"18.5\" y=\"24\">` + waypoint.name + `</tspan>\n            </text>\n        </g>`;\n        let svgPrefix: string = '<svg version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" viewBox=\"0 0 43 43\" xml:space=\"preserve\">';\n        let svgSuffix: string = '</svg>';\n        let svgString: string = svgPrefix + svgCircle + svgSuffix;\n\n        // let newWaypoint: string =\n        // `<svg width=\"35\" height=\"35\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:svg=\"http://www.w3.org/2000/svg\">\n        //     <g>\n        //         <title>Layer 1</title>\n        //         <g id=\"diamond\">\n        //             <rect id=\"svg_1\" height=\"25\" width=\"25\" fill-opacity=\"0.5\" fill=\"#0A92EA\" transform=\"matrix(0.7071,-0.7071,0.7071,0.7071,-8.4939,20.5061) \" y=\"4.006014\" x=\"8.006292\"/>\n        //             <rect id=\"svg_2\" height=\"25\" width=\"25\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"#FFFFFF\" fill=\"none\" transform=\"matrix(0.7071,-0.7071,0.7071,0.7071,-8.4939,20.5061) \" y=\"4.006012\" x=\"8.006292\"/>\n        //         </g>\n        //         <g stroke=\"null\" id=\"number\">\n        //             <text stroke-width=\"0\" stroke=\"null\" font-weight=\"normal\" font-style=\"normal\" x=\"50%\" y=\"50%\" id=\"svg_3\" font-size=\"15px\" font-family=\"&#x27;OpenSans-Semibold'\" fill=\"#FFFFFF\" transform=\"matrix(1,0,0,0.9583181738853455,13.0693,25.413596181405495) \">` + waypoint.name + `</text>\n        //         </g>\n        //     </g>\n        // </svg>`;\n\n        // create the cesium entity\n        let svgEntityImage: any = svgDataDeclare + svgString;\n\n        waypoint.entity = this.mapEntityCollection.entities.add({\n            name: waypoint.name,\n            id: this.sessionId + waypoint.name,\n            polyline: {\n                // positions: new Cesium.CallbackProperty( (): any => {\n                //     return Cesium.Cartesian3.fromDegreesArrayHeights(\n                //         [waypoint.longitude, waypoint.latitude, waypoint.hae,\n                //             waypoint.longitude, waypoint.latitude, waypoint.altitudeAGL + this.drone.homeHAE]);\n                // }, false) ,\n                positions: Cesium.Cartesian3.fromDegreesArrayHeights(\n                        [waypoint.longitude, waypoint.latitude, waypoint.hae,\n                            waypoint.longitude, waypoint.latitude, waypoint.altitudeAGL + this.drone.homeHAE]),\n                width: 2,\n                followSurface: false,\n                material: Cesium.Color.WHITE\n            },\n            // position: new Cesium.CallbackProperty( (): any => {\n            //     return Cesium.Cartesian3.fromDegrees(waypoint.longitude, waypoint.latitude, waypoint.altitudeAGL + this.drone.homeHAE);\n            // }, false),\n            position: Cesium.Cartesian3.fromDegrees(waypoint.longitude, waypoint.latitude, waypoint.altitudeAGL + this.drone.homeHAE),\n            billboard: {\n                    image: svgEntityImage,\n                    sizeInMeters : false,\n                    width : 43,\n                    height : 43,\n                    pixelOffset: new Cesium.Cartesian2(3, 7),\n                    verticalOrigin : Cesium.VerticalOrigin.BOTTOM,\n            }\n            // point: {\n            //     pixelSize: 10,\n            //     color: Cesium.Color.fromBytes(255, 255, 255, 0),\n            //     outlineColor: Cesium.Color.fromBytes(255, 255, 255, 255),\n            //     outlineWidth: 2\n            // }\n        });\n\n        // Add bottom triangle to waypoint line\n        //  TODO - Track this entity so it can be removed later\n        // this.mapEntityCollection.add({\n        //     position: Cesium.Cartesian3.fromDegrees(waypoint.longitude, waypoint.latitude, 50),\n        //     billboard: {\n        //             image: svgEntityImage,\n        //             sizeInMeters : false,\n        //             width : 5,\n        //             height : 5,\n        //             pixelOffset: new Cesium.Cartesian2(3,7),\n        //             verticalOrigin : Cesium.VerticalOrigin.BOTTOM,\n        //             heightReference: Cesium.HeightReference.RELATIVE_TO_GROUND\n        //     }\n        // });\n\n        // Wire up handler to listen for left click\n        // this.editingHandler.setInputAction( (click: any): void => {\n\n        //     // Check to see what the mouse has selected\n        //     var pickedObject: any = this.map.scene.pick(click.position);\n\n        //     // Check to make sure we are only grabbing the entity we are editing\n        //     if (Cesium.defined(pickedObject) && pickedObject.id === this.entity) {\n        //         console.log(pickedObject.id);\n        //         this.ShowMenu();\n        //     }\n        // }, Cesium.ScreenSpaceEventType.LEFT_CLICK);\n\n        } catch (error) {\n            this.$log.error({ message: 'Error in adding waypoint to map code.', error: error });\n        }\n    }\n\n    terrainProvider: any = new Cesium.CesiumTerrainProvider({\n        url : 'https://www.cesiumcontent.com/api/terrain/world?access_token=eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJqdGkiOiJkMTM4ZDE2OS05NWYwLTQ0YmItOWY3YS0yNjEwOGE5Y2Y3NjYiLCJpZCI6NywiaWF0IjoxNDU1MjkyNzg5fQ.NDKlrwQZE_04ntDuL89hvatEmuycQo5llhtz3Mi6Wo0'\n        //url: '//assets.agi.com/stk-terrain/world'\n    });\n\n    getHAE(latitude: number, longitude: number): Promise<number> {\n                \n        return new Promise<number>((resolve) => {\n\n            var positions: Array<Cesium.Cartographic> = [\n                Cesium.Cartographic.fromDegrees(longitude, latitude)\n            ];\n\n            try {\n\n                // Get terrain height at click location before adding takeoff point\n                Cesium.sampleTerrain(this.terrainProvider, 15, positions).then((updatedPositions: any): void => {\n                    \n                    resolve(updatedPositions[0].height);\n\n                });\n            } catch (error) {\n                this.$log.error({ message: 'Error in getting waypoing HAE', error: error });\n            }\n\n        });\n    }\n\n    // Variable for interval timer\n    intervalTimer: any;\n\n    startInterval(): void {\n\n        this.intervalTimer = setInterval(() => {\n\n            if (this.waypoints.length > 0 && this.currentWaypoint) {\n                this.calculateTimeAndDistance();\n            }\n\n        }, 500);\n    }\n\n    // TODO: Refactor into loop\n    calculateTimeAndDistance(): void {\n\n        try {\n            if (this.waypoints.length === 0) {\n                return;\n            }\n\n            let currentTotal: number = 0;\n\n            // first calculate distance from drone to next waypoint and set as distance for that waypoint\n            currentTotal = this.currentWaypoint.distance = +(Conversions.distance2(this.drone.currentLat, this.drone.currentLng, this.currentWaypoint.latitude, this.currentWaypoint.longitude).toFixed());\n            this.currentWaypoint.time = (this.currentWaypoint.distance / this.drone.drone.FlightController.Telemetry.Position.groundSpeed) * 1000;\n            // second do same for the next 5 waypoints adding the previous total\n\n            if (this.waypoints[this.currentIndex + 1]) {\n\n                currentTotal += +(Conversions.distance2(this.currentWaypoint.latitude, this.currentWaypoint.longitude, this.waypoints[this.currentIndex + 1].latitude, this.waypoints[this.currentIndex + 1].longitude).toFixed(2));\n                this.waypoints[this.currentIndex + 1].distance = +currentTotal.toFixed();\n                this.waypoints[this.currentIndex + 1].time = (currentTotal / this.drone.drone.FlightController.Telemetry.Position.groundSpeed) * 1000;\n            }\n\n            if (this.waypoints[this.currentIndex + 2]) {\n\n                currentTotal += +(Conversions.distance2(this.waypoints[this.currentIndex + 1].latitude, this.waypoints[this.currentIndex + 1].longitude, this.waypoints[this.currentIndex + 2].latitude, this.waypoints[this.currentIndex + 2].longitude).toFixed(2));\n                this.waypoints[this.currentIndex + 2].distance = +currentTotal.toFixed();\n                this.waypoints[this.currentIndex + 2].time = (currentTotal / this.drone.drone.FlightController.Telemetry.Position.groundSpeed) * 1000;\n            }\n\n            if (this.waypoints[this.currentIndex + 3]) {\n\n                currentTotal += +(Conversions.distance2(this.waypoints[this.currentIndex + 2].latitude, this.waypoints[this.currentIndex + 2].longitude, this.waypoints[this.currentIndex + 3].latitude, this.waypoints[this.currentIndex + 3].longitude).toFixed(2));\n                this.waypoints[this.currentIndex + 3].distance = +currentTotal.toFixed();\n                this.waypoints[this.currentIndex + 3].time = (currentTotal / this.drone.drone.FlightController.Telemetry.Position.groundSpeed) * 1000;\n            }\n\n            if (this.waypoints[this.currentIndex + 4]) {\n\n                currentTotal += +(Conversions.distance2(this.waypoints[this.currentIndex + 3].latitude, this.waypoints[this.currentIndex + 3].longitude, this.waypoints[this.currentIndex + 4].latitude, this.waypoints[this.currentIndex + 4].longitude).toFixed(2));\n                this.waypoints[this.currentIndex + 4].distance = +currentTotal.toFixed();\n                this.waypoints[this.currentIndex + 4].time = (currentTotal / this.drone.drone.FlightController.Telemetry.Position.groundSpeed) * 1000;\n            }\n        } catch (error) {\n            this.$log.error({ message: 'calculate time and distance function', error: error });\n        }\n    }\n}\n"],"sourceRoot":"/source/"}